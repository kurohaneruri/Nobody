# 测试剧本加载功能指南

## 已完成的修复

1. ? 实现了 `load_script` Tauri 命令
2. ? 修复了 `ScriptSelector` 组件的剧本加载逻辑
3. ? 创建了完整的测试剧本文件
4. ? 所有代码已提交并推送到 GitHub

## 测试步骤

### 1. 启动应用

```bash
npm run tauri dev
```

### 2. 测试剧本加载

1. 点击"新游戏"按钮
2. 选择"自定义剧本"
3. 在文件选择对话框中，导航到项目根目录的 `example_scripts` 文件夹
4. 选择 `test_script.json` 文件
5. 应用将加载剧本并初始化游戏

### 3. 验证加载成功

如果加载成功，你应该看到：

- 游戏界面正常显示
- 左侧角色面板显示：
  - 角色名：林凡
  - 修为境界：练气期
  - 灵根：Fire (Heavenly)
  - 位置：青云宗
  - 年龄：16 岁
- 主界面显示剧情文本和可选行动

### 4. 可能的错误

如果出现错误，请检查：

1. **文件路径错误**：确保选择的是正确的 JSON 文件
2. **JSON 格式错误**：确保文件是有效的 JSON 格式
3. **验证失败**：检查剧本是否包含所有必需字段

## 测试剧本内容

`example_scripts/test_script.json` 包含：

- **角色**：林凡，16 岁，天灵根（火属性）
- **起始地点**：青云宗
- **修仙境界**：练气期、筑基期、金丹期、元婴期、化神期
- **功法**：基础聚气诀、烈焰掌、水盾术、金丹凝练法
- **地点**：青云宗、迷雾森林、凡人镇、灵石矿
- **势力**：青云宗（正道）、暗影阁（中立）、血魔宗（邪道）

## 自定义剧本

你可以参考 `example_scripts/test_script.json` 创建自己的剧本。

必需字段：
- `id`: 剧本唯一标识
- `name`: 剧本名称
- `script_type`: "Custom"
- `world_setting`: 包含 cultivation_realms, locations 等
- `initial_state`: 包含 player_name, starting_location, starting_age 等

验证规则：
- 至少 1 个修仙境界
- 至少 1 个地点
- 起始地点必须存在于地点列表中
- 起始年龄必须在 10-100 之间

## 调试信息

如果遇到问题，可以：

1. 打开浏览器开发者工具（F12）查看控制台日志
2. 查看 Tauri 后端日志（在终端中）
3. 检查错误提示信息

## 下一步

测试成功后，你可以：

1. 尝试创建自己的剧本
2. 测试游戏的其他功能（保存、加载等）
3. 继续开发第二阶段功能（LLM 集成）
